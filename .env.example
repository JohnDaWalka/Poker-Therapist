# Poker Therapist - AI Chatbot Configuration
# Copy this file to .env.local and add your API keys

# ============================================================================
# CHATBOT PROVIDER CONFIGURATION
# ============================================================================

# Choose your preferred chatbot provider: openai, anthropic, google, xai, perplexity
# Default: openai (ChatGPT)
CHATBOT_PROVIDER=openai

# OpenAI API Key (for ChatGPT - GPT-4, GPT-3.5, etc.)
# Get your API key from: https://platform.openai.com/api-keys
OPENAI_API_KEY=your_openai_api_key_here

# xAI API Key (for Grok chat)
# Get your API key from: https://x.ai/api
XAI_API_KEY=xai-your-api-key-here

# Anthropic API Key (for Claude)
# Get your API key from: https://console.anthropic.com/
ANTHROPIC_API_KEY=your_anthropic_api_key_here

# Google AI API Key (for Gemini)
# Get your API key from: https://makersuite.google.com/app/apikey
GOOGLE_AI_API_KEY=your_google_ai_api_key_here

# Perplexity API Key (for Perplexity AI with real-time research)
# Get your API key from: https://www.perplexity.ai/settings/api
PERPLEXITY_API_KEY=your_perplexity_api_key_here

# Voice Features Configuration
# Enable/disable voice features
VOICE_ENABLED=true

# Voice provider for TTS/STR: openai (recommended), xai
VOICE_PROVIDER=openai

# Enhanced Voice Features (New)
# Enable real-time voice streaming with WebRTC
ENABLE_VOICE_STREAMING=true

# Enable voice activity detection (VAD)
ENABLE_VAD=true

# Enable emotion analysis from voice
ENABLE_EMOTION_ANALYSIS=true

# Enable voice cloning for custom Rex voices
ENABLE_VOICE_CLONING=true

# Default Rex language (en, es, fr, de, it, pt, ja, zh)
DEFAULT_REX_LANGUAGE=en

# Conversation mode (single_turn, continuous, voice_activated)
DEFAULT_CONVERSATION_MODE=single_turn

# Voice Activity Detection sensitivity (0-3, where 3 is most sensitive)
VAD_SENSITIVITY=2

# Authorized VIP users (comma-separated email addresses)
# Leave empty to use default list in chatbot_app.py
# Includes: Apple iCloud accounts (@icloud.com), Google Gmail accounts (@gmail.com), 
# and institutional Microsoft accounts (@ctstate.edu)
AUTHORIZED_EMAILS=m.fanelli1@icloud.com,johndawalka@icloud.com,mauro.fanelli@ctstate.edu,maurofanellijr@gmail.com,cooljack87@icloud.com,jdwalka@pm.me

# Legacy Vue frontend API keys (optional - for Vue.js frontend only)
VUE_APP_PERPLEXITY_API_KEY=your_perplexity_api_key_here
VUE_APP_ANTHROPIC_API_KEY=your_anthropic_api_key_here
VUE_APP_GEMINI_API_KEY=your_gemini_api_key_here

# n8n Workflow Automation Configuration
# n8n instance URL (where your n8n server is running)
N8N_WEBHOOK_URL=http://localhost:5678/webhook

# n8n API Key (optional - for triggering workflows from the app)
# Get from n8n: Settings -> API
N8N_API_KEY=your-n8n-api-key-here

# Poker Therapist API base URL (for n8n to call back)
API_BASE_URL=http://localhost:8000

# External services for n8n workflows (optional)
# Twilio (for SMS alerts)
TWILIO_PHONE=+1234567890
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token

# Slack (for notifications)
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# Discord (for bot integration)
DISCORD_WEBHOOK_URL=https://discord.com/api/webhooks/YOUR/WEBHOOK

# Google Sheets (for data export)
GOOGLE_SHEET_ID=your-google-sheet-id
GOOGLE_SERVICE_ACCOUNT_EMAIL=your-service-account@project.iam.gserviceaccount.com

# ============================================================================
# AUTHENTICATION & IDENTITY PROVIDERS
# ============================================================================

# JWT Secret Key for token generation and validation
# Generate a strong random secret: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET_KEY=your-secure-jwt-secret-key-here
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24

# ============================================================================
# MICROSOFT AUTHENTICATION (Windows, Azure AD, Institutional SSO)
# ============================================================================

# Microsoft Azure AD Configuration
# Get credentials from: https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade
# Register your app and configure redirect URIs for each platform

# Azure AD Tenant ID (Directory ID)
AZURE_TENANT_ID=your-tenant-id-here

# Azure AD Client ID (Application ID)
AZURE_CLIENT_ID=your-client-id-here

# Azure AD Client Secret (for backend server-side authentication)
# WARNING: Never commit this to source control
AZURE_CLIENT_SECRET=your-client-secret-here

# Azure AD Authority URL (for specific tenant or common for multi-tenant)
# For single tenant: https://login.microsoftonline.com/{tenant-id}
# For multi-tenant: https://login.microsoftonline.com/common
# For institutional SSO (e.g., ctstate.edu): https://login.microsoftonline.com/{tenant-id}
AZURE_AUTHORITY=https://login.microsoftonline.com/common

# Microsoft Graph API Scopes (space-separated)
# Example: User.Read email profile openid
AZURE_SCOPES=User.Read email profile openid

# Institutional Email Domain for SSO (e.g., ctstate.edu)
# Leave empty to allow all Microsoft accounts
INSTITUTIONAL_EMAIL_DOMAIN=ctstate.edu

# Redirect URIs for each platform
# iOS: msauth.{bundle-id}://auth
# Windows: http://localhost:3000/auth/callback
# Web: https://your-domain.com/auth/callback
AZURE_REDIRECT_URI_IOS=msauth.com.therapyrex.app://auth
AZURE_REDIRECT_URI_WINDOWS=http://localhost:3000/auth/callback
AZURE_REDIRECT_URI_WEB=http://localhost:8501/auth/callback

# ============================================================================
# GOOGLE CLOUD PLATFORM & OAUTH 2.0
# ============================================================================

# Google Cloud Project Configuration
# Get credentials from: https://console.cloud.google.com/apis/credentials
# Create OAuth 2.0 Client ID and enable required APIs

# Google Cloud Project ID
GOOGLE_CLOUD_PROJECT_ID=your-project-id-here

# Google OAuth 2.0 Client ID (for web applications)
GOOGLE_CLIENT_ID=your-client-id.apps.googleusercontent.com

# Google OAuth 2.0 Client Secret
# WARNING: Never commit this to source control
GOOGLE_CLIENT_SECRET=your-client-secret-here

# Google OAuth Redirect URIs
GOOGLE_REDIRECT_URI_IOS=com.googleusercontent.apps.your-client-id:/oauth2callback
GOOGLE_REDIRECT_URI_WINDOWS=http://localhost:3000/google/callback
GOOGLE_REDIRECT_URI_WEB=http://localhost:8501/google/callback

# Google OAuth Scopes (space-separated)
# Common scopes: openid email profile
# Cloud Storage: https://www.googleapis.com/auth/devstorage.read_write
# See: https://developers.google.com/identity/protocols/oauth2/scopes
GOOGLE_OAUTH_SCOPES=openid email profile https://www.googleapis.com/auth/devstorage.read_write

# ============================================================================
# GOOGLE CLOUD SERVICES
# ============================================================================

# Google Cloud Storage Configuration
# Bucket name for storing user data, voice recordings, session data
GOOGLE_STORAGE_BUCKET_NAME=poker-therapist-data

# Google Cloud Storage Region (e.g., us-central1, europe-west1)
GOOGLE_STORAGE_REGION=us-central1

# Google Service Account Credentials (JSON file path)
# Download from: Cloud Console > IAM & Admin > Service Accounts
# Path can be absolute or relative to project root
GOOGLE_APPLICATION_CREDENTIALS=./config/google-service-account.json

# Alternative: Set service account key as JSON string
# GOOGLE_SERVICE_ACCOUNT_JSON={"type":"service_account","project_id":"..."}

# Google Cloud APIs to Enable
# - Cloud Storage API
# - Cloud Speech-to-Text API (if using Google for voice)
# - Cloud Text-to-Speech API (if using Google for voice)
# - Identity Platform (for authentication)
# Enable at: https://console.cloud.google.com/apis/library

# Google Cloud Storage Options
GOOGLE_STORAGE_PUBLIC_ACCESS=false
GOOGLE_STORAGE_UNIFORM_BUCKET_LEVEL_ACCESS=true

# ============================================================================
# APPLE SIGN-IN (iOS, macOS, watchOS)
# ============================================================================

# Apple Developer Team ID
# Get from: https://developer.apple.com/account
APPLE_TEAM_ID=your-team-id-here

# Apple Services ID (for Sign in with Apple)
# Register at: https://developer.apple.com/account/resources/identifiers/list/serviceId
APPLE_SERVICES_ID=com.therapyrex.signin

# Apple Key ID (for Sign in with Apple)
APPLE_KEY_ID=your-key-id-here

# Apple Private Key (for Sign in with Apple server-side validation)
# Download from: https://developer.apple.com/account/resources/authkeys/list
# Path to .p8 file
APPLE_PRIVATE_KEY_PATH=./config/apple-auth-key.p8

# Alternative: Set private key content as string
# APPLE_PRIVATE_KEY=-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----

# Apple Bundle IDs for each platform
APPLE_BUNDLE_ID_IOS=com.therapyrex.app
APPLE_BUNDLE_ID_WATCHOS=com.therapyrex.app.watchkitapp

# ============================================================================
# AUTHENTICATION SETTINGS
# ============================================================================

# Enable/disable authentication providers
ENABLE_MICROSOFT_AUTH=true
ENABLE_GOOGLE_AUTH=true
ENABLE_APPLE_AUTH=true

# Default authentication provider (microsoft, google, apple)
DEFAULT_AUTH_PROVIDER=microsoft

# Require authentication for API access
REQUIRE_AUTHENTICATION=true

# Allow anonymous access for certain endpoints
ALLOW_ANONYMOUS_TRIAGE=false

# Session timeout (in hours)
SESSION_TIMEOUT_HOURS=24

# Refresh token expiration (in days)
REFRESH_TOKEN_EXPIRATION_DAYS=30

# ============================================================================
# SECURITY POLICIES
# ============================================================================

# IMPORTANT: Follow your organization's security policies
# - Never commit credentials or secrets to source control
# - Use environment variables or secure secret management (Azure Key Vault, Google Secret Manager)
# - Rotate credentials regularly
# - Use separate credentials for development, staging, and production
# - Enable MFA for all admin accounts
# - Review and audit access logs regularly
# - Follow principle of least privilege for service accounts

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8501,http://localhost:5173

# Enable HTTPS only in production
FORCE_HTTPS=false

# Rate limiting
RATE_LIMIT_PER_MINUTE=60

# ============================================================================
# DEPLOYMENT VERIFICATION
# ============================================================================

# To verify authentication is working end-to-end:
# 
# 1. Test Microsoft account login (institutional email):
#    - Use: mauro.fanelli@ctstate.edu
#    - Requires: Azure AD configuration with institutional tenant
#
# 2. Test Google OAuth flow (Gmail accounts and GCP APIs):
#    - Use: maurofanellijr@gmail.com
#    - Requires: Google Cloud Platform OAuth credentials
#
# 3. Test Apple Sign-In (iCloud accounts on iOS/watchOS):
#    - Use: m.fanelli1@icloud.com
#    - Requires: Apple Developer account and Services ID
#
# 4. Verify tokens are correctly generated and validated
# 5. Test API access with authentication headers
# 6. Verify Google Cloud Storage connectivity with service account
# 7. Test automated CI/CD workflows with environment variables
# 8. Verify container deployments with proper secret injection
#
# See AUTHENTICATION_VERIFICATION.md for detailed testing instructions
